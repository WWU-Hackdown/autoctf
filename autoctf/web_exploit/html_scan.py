import requests
from autoctf import check_flag
from tqdm import tqdm
import re

def _get_html(url, headers={},data={}):
	r = requests.get(url,headers=headers,data=data)
	#print(r.content)
	return r.content

def check_flag_in_html(url,headers={},data={}):
	s = _get_html(url,headers,data)
	check_flag(s)

def auto_check_flag_in_url_html(url,headers={},data={}):
	for user in tqdm(["admin","root","host"]):
		th = headers.copy()
		th["Cookie"] = "user=" + user
		check_flag_in_html(url,th,data)
